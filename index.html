<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kelime UygulamasÄ± - v39 (C Seviye GÃ¼ncel)</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; padding: 0; font-family: sans-serif; background-color: #2c3e50; color: white; height: 100dvh; overflow: hidden; }
        .app-container { width: 100%; max-width: 600px; margin: 0 auto; background-color: #4a6a7a; height: 100%; display: flex; flex-direction: column; position: relative; }
        
        .fixed-header-group { background-color: #354f5c; box-shadow: 0 2px 10px rgba(0,0,0,0.3); z-index: 10; }
        header.home-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; height: 60px; }
        .tabs { display: flex; overflow-x: auto; height: 50px; align-items: center; scrollbar-width: none; }
        .tabs::-webkit-scrollbar { display: none; }
        .tab { padding: 0 15px; height: 100%; display: flex; align-items: center; color: #bdc3c7; font-weight: bold; font-size: 13px; cursor: pointer; flex-shrink: 0; }
        .tab.active { color: #f1c40f; border-bottom: 4px solid #f1c40f; }

        .content-area { flex-grow: 1; overflow-y: auto; padding: 15px; padding-bottom: 80px; }
        .level-card { background-color: #3e5c6a; border: 2px solid #d4a35a; border-radius: 12px; display: flex; align-items: center; justify-content: space-between; padding: 18px; margin-bottom: 12px; cursor: pointer; }
        .level-card.completed { background-color: #27ae60; border-color: #2ecc71; }
        .level-icon { font-size: 22px; margin-right: 12px; }

        #list-screen { display: none; flex-direction: column; position: fixed; inset: 0; background-color: #2c3e50; z-index: 5000; }
        .list-header { padding: 15px; display: flex; align-items: center; background-color: #354f5c; }
        .back-btn { font-size: 24px; background: none; border: none; color: white; cursor: pointer; padding: 5px 15px; }
        .list-content { flex-grow: 1; overflow-y: auto; padding: 15px; padding-bottom: 100px; }
        .word-row { display: flex; justify-content: space-between; padding: 15px; margin-bottom: 8px; background: rgba(255,255,255,0.05); border-radius: 8px; }

        #quiz-screen { display: none; flex-direction: column; position: fixed; inset: 0; background-color: #1a1a1a; z-index: 9999; padding: 20px; }
        .quiz-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .progress-track { flex-grow: 1; height: 10px; background: #333; margin: 0 15px; border-radius: 5px; overflow: hidden; }
        #progress-fill { height: 100%; background: #3498db; width: 0%; transition: 0.3s; }
        .options { width: 100%; display: flex; flex-direction: column; gap: 10px; }
        .option-btn { background: #333; border: none; color: white; padding: 15px; border-radius: 10px; font-size: 16px; font-weight: bold; }
        .option-btn.correct { background: #27ae60; }
        .option-btn.wrong { background: #e74c3c; }

        .fixed-bottom-btn-container { position: absolute; bottom: 0; left: 0; right: 0; padding: 20px; background: linear-gradient(transparent, #2c3e50); }
        .start-quiz-btn { width: 100%; padding: 16px; background: #27ae60; border: none; color: white; border-radius: 12px; font-size: 18px; font-weight: bold; }
        
        .backup-group { display: flex; gap: 10px; margin-top: 10px; }
        .backup-btn { flex: 1; padding: 12px; border: none; border-radius: 8px; color: white; font-weight: bold; font-size: 12px; cursor: pointer; }
        .btn-dl { background: #2980b9; }
        .btn-ul { background: #8e44ad; }

        #success-overlay { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); width: 80px; height: 80px; background: #27ae60; border-radius: 50%; z-index: 10002; justify-content: center; align-items: center; }
        .checkmark { width: 20px; height: 40px; border-bottom: 6px solid white; border-right: 6px solid white; transform: rotate(45deg); margin-top: -5px; }
        
        #result-screen { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 10005; flex-direction: column; align-items: center; justify-content: center; }
        .form-select, .form-textarea { width: 100%; padding: 10px; margin-bottom: 10px; background: #2c3e50; color: white; border: 1px solid #555; border-radius: 5px; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="fixed-header-group">
        <header class="home-header">
            <div style="font-size:24px;">ðŸ“–</div>
            <div style="font-weight:bold;">KELÄ°ME v39</div>
            <div style="font-size:24px;">ðŸ‘¤</div>
        </header>
        <div class="tabs">
            <div class="tab active" onclick="switchTab('YDS', this)">YDS</div>
            <div class="tab" onclick="switchTab('H', this)">HABER</div>
            <div class="tab" onclick="switchTab('B2', this)">B2</div>
            <div class="tab" onclick="switchTab('C', this)">C</div>
            <div class="tab" onclick="switchTab('ADD', this)">âž• EKLE</div>
        </div>
    </div>

    <div class="content-area" id="content-container"></div>

    <div id="list-screen">
        <div class="list-header">
            <button class="back-btn" onclick="closeListScreen()">â¬…</button>
            <h3 id="list-title" style="margin:0; flex-grow:1; text-align:center;">Liste</h3>
        </div>
        <div class="list-content" id="list-content-area"></div>
        <div class="fixed-bottom-btn-container">
            <button class="start-quiz-btn" id="btn-start-quiz">TESTÄ° BAÅžLAT</button>
        </div>
    </div>

    <div id="quiz-screen">
        <div class="quiz-header">
            <div style="font-size:24px; cursor:pointer;" onclick="quitQuiz()">âœ•</div>
            <div class="progress-track"><div id="progress-fill"></div></div>
            <div id="progress-text">0/0</div>
        </div>
        <div style="text-align:center; flex-grow:1; display:flex; flex-direction:column; justify-content:center;">
            <div style="font-size:40px; margin-bottom:20px; cursor:pointer;" onclick="speakCurrent()">ðŸ”Š</div>
            <h1 id="target-word" style="font-size:36px; margin:0 0 40px 0;">...</h1>
            <div class="options" id="options-container"></div>
        </div>
        <div id="success-overlay"><div class="checkmark"></div></div>
    </div>

    <div id="result-screen">
        <h2 style="color:#f1c40f">TamamlandÄ±!</h2>
        <h1 id="final-score" style="font-size:48px;">0/0</h1>
        <button class="start-quiz-btn" style="width:200px; background:#f1c40f; color:black;" onclick="location.reload()">ANA MENÃœ</button>
    </div>
</div>

<input type="file" id="file-input" style="display:none" onchange="importData(this)">

<script>
    const DB_KEY = 'VocabApp_v39_Final';
    let vocabularyData = {};
    let activeCategory = 'YDS';
    let activeLevel = 1;
    let currentQuestions = [];
    let currentStep = 0;
    let corrects = 0;

    const cLevel1Words = [
        { "en": "Ubiquitous", "tr": "Her yerde bulunan" },
        { "en": "Pragmatic", "tr": "UygulamacÄ±, faydacÄ±" },
        { "en": "Eloquent", "tr": "GÃ¼zel ve etkili konuÅŸan" },
        { "en": "Ambiguous", "tr": "Belirsiz, iki anlamlÄ±" },
        { "en": "Resilient", "tr": "DirenÃ§li, Ã§abuk iyileÅŸen" },
        { "en": "Exacerbate", "tr": "KÃ¶tÃ¼leÅŸtirmek, ÅŸiddetlendirmek" },
        { "en": "Meticulous", "tr": "Titiz, kÄ±lÄ± kÄ±rk yaran" },
        { "en": "Inevitably", "tr": "KaÃ§Ä±nÄ±lmaz bir ÅŸekilde" },
        { "en": "Advocate", "tr": "Savunmak, desteklemek" },
        { "en": "Comprehensive", "tr": "KapsamlÄ±, detaylÄ±" },
        { "en": "Plausible", "tr": "Makul, akla yatkÄ±n" },
        { "en": "Substantial", "tr": "Ã–nemli, oldukÃ§a bÃ¼yÃ¼k" },
        { "en": "Abstract", "tr": "Soyut" },
        { "en": "Paradigm", "tr": "Ã–rneklem, deÄŸerler dizisi" },
        { "en": "Profound", "tr": "Derin, kÃ¶klÃ¼" },
        { "en": "Arbitrary", "tr": "Keyfi, rastgele" },
        { "en": "Coherent", "tr": "TutarlÄ±, uyumlu" },
        { "en": "Deceptive", "tr": "AldatÄ±cÄ±, yanÄ±ltÄ±cÄ±" },
        { "en": "Emphasize", "tr": "Vurgulamak" },
        { "en": "Formidable", "tr": "Zorlu, Ã¼rkÃ¼tÃ¼cÃ¼ derecede gÃ¼Ã§lÃ¼" }
    ];

    function init() {
        const saved = localStorage.getItem(DB_KEY);
        if(saved) {
            vocabularyData = JSON.parse(saved);
        } else {
            vocabularyData = { 
                progress: { YDS:{}, H:{}, B2:{}, B1:{}, C:{} }, 
                YDS:{}, H:{}, B2:{}, B1:{}, C:{} 
            };
            // YDS 60 Seviye
            for(let i=1; i<=60; i++) vocabularyData.YDS[i] = [{en:"Sample", tr:"Ã–rnek"}];
            // C 1. Seviyeye yeni kelimeleri ekle
            vocabularyData.C[1] = cLevel1Words;
            // DiÄŸer C seviyeleri ve kategoriler
            for(let i=2; i<=20; i++) vocabularyData.C[i] = [{en:"Sample", tr:"Ã–rnek"}];
            ["H","B2","B1"].forEach(cat => {
                for(let i=1; i<=30; i++) vocabularyData[cat][i] = [{en:"Sample", tr:"Ã–rnek"}];
            });
            save();
        }
        switchTab('YDS', document.querySelector('.tab'));
    }

    function save() { localStorage.setItem(DB_KEY, JSON.stringify(vocabularyData)); }

    function switchTab(cat, el) {
        activeCategory = cat;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        if(el) el.classList.add('active');
        const container = document.getElementById('content-container');
        container.innerHTML = "";

        if(cat === 'ADD') {
            renderAddScreen();
        } else {
            let limit = cat === 'YDS' ? 60 : (cat === 'C' ? 20 : 30);
            for(let i=1; i<=limit; i++) {
                let isDone = (vocabularyData.progress[cat] && vocabularyData.progress[cat][i] >= 1);
                let count = vocabularyData[cat][i] ? vocabularyData[cat][i].length : 0;
                container.innerHTML += `
                    <div class="level-card ${isDone ? 'completed' : ''}" onclick="openList(${i})">
                        <div style="display:flex; align-items:center;">
                            <span class="level-icon">ðŸ“˜</span>
                            <b>${i}. Seviye</b>
                        </div>
                        <span style="font-size:12px; opacity:0.7;">${count} Kelime ${isDone ? 'âœ…' : '>>'}</span>
                    </div>`;
            }
        }
    }

    function openList(lvl) {
        activeLevel = lvl;
        const words = vocabularyData[activeCategory][lvl] || [];
        document.getElementById('list-title').innerText = `${activeCategory} - ${lvl}. Seviye`;
        const area = document.getElementById('list-content-area');
        area.innerHTML = words.map(w => `<div class="word-row"><b>${w.en}</b> <i>${w.tr}</i></div>`).join('');
        document.getElementById('btn-start-quiz').onclick = () => startQuiz(words);
        document.getElementById('list-screen').style.display = 'flex';
    }

    function closeListScreen() { document.getElementById('list-screen').style.display = 'none'; }

    function startQuiz(words) {
        if(words.length < 2) { alert("Yeterli kelime yok!"); return; }
        currentQuestions = words.map(w => {
            let opts = [w.tr];
            while(opts.length < 4) {
                let r = words[Math.floor(Math.random()*words.length)].tr;
                if(!opts.includes(r)) opts.push(r);
            }
            return { en: w.en, correct: w.tr, options: opts.sort(()=>Math.random()-0.5) };
        });
        currentStep = 0; corrects = 0;
        document.getElementById('list-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'flex';
        renderQuestion();
    }

    function renderQuestion() {
        if(currentStep >= currentQuestions.length) { showFinal(); return; }
        let q = currentQuestions[currentStep];
        document.getElementById('target-word').innerText = q.en;
        document.getElementById('progress-text').innerText = (currentStep+1) + "/" + currentQuestions.length;
        document.getElementById('progress-fill').style.width = ((currentStep+1)/currentQuestions.length)*100 + "%";
        document.getElementById('options-container').innerHTML = q.options.map(opt => `
            <button class="option-btn" onclick="checkAnswer(this, '${opt}', '${q.correct}')">${opt}</button>
        `).join('');
    }

    function checkAnswer(btn, sel, cor) {
        const btns = document.querySelectorAll('.option-btn');
        btns.forEach(b => b.disabled = true);
        if(sel === cor) {
            btn.classList.add('correct'); corrects++;
            document.getElementById('success-overlay').style.display = 'flex';
            setTimeout(() => { document.getElementById('success-overlay').style.display = 'none'; next(); }, 600);
        } else {
            btn.classList.add('wrong');
            btns.forEach(b => { if(b.innerText === cor) b.classList.add('correct'); });
            setTimeout(next, 1200);
        }
    }

    function next() { currentStep++; renderQuestion(); }

    function showFinal() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'flex';
        document.getElementById('final-score').innerText = corrects + "/" + currentQuestions.length;
        if(corrects === currentQuestions.length) {
            vocabularyData.progress[activeCategory][activeLevel] = 1;
            save();
        }
    }

    function quitQuiz() { if(confirm("Ã‡Ä±kÄ±lsÄ±n mÄ±?")) location.reload(); }

    function renderAddScreen() {
        document.getElementById('content-container').innerHTML = `
            <div style="background:rgba(0,0,0,0.2); padding:20px; border-radius:15px;">
                <h3>Kelime Ekle</h3>
                <select id="add-lvl" class="form-select">${Array.from({length:60},(_,i)=>`<option value="${i+1}">${i+1}. Seviye</option>`).join('')}</select>
                <textarea id="add-txt" class="form-textarea" rows="5" placeholder="Word : AnlamÄ±"></textarea>
                <button class="save-btn" style="width:100%; padding:12px; background:#f1c40f; border:none; border-radius:8px; font-weight:bold;" onclick="processAdd()">KAYDET</button>
                <hr style="border:0; border-top:1px solid #555; margin:20px 0;">
                <h3>Veri YÃ¶netimi</h3>
                <div class="backup-group">
                    <button class="backup-btn btn-dl" onclick="exportData()">YEDEÄžÄ° Ä°NDÄ°R (JSON)</button>
                    <button class="backup-btn btn-ul" onclick="document.getElementById('file-input').click()">YEDEÄžÄ° YÃœKLE</button>
                </div>
            </div>`;
    }

    function processAdd() {
        let lvl = document.getElementById('add-lvl').value;
        let txt = document.getElementById('add-txt').value;
        if(!txt) return;
        txt.split('\n').forEach(line => {
            let p = line.split(/[:=]/);
            if(p.length === 2) vocabularyData[activeCategory][lvl].push({en:p[0].trim(), tr:p[1].trim()});
        });
        save(); alert("Eklendi!");
        document.getElementById('add-txt').value = "";
    }

    function exportData() {
        const blob = new Blob([JSON.stringify(vocabularyData)], {type: 'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `kelime_yedek_${new Date().toLocaleDateString()}.json`;
        a.click();
    }

    function importData(input) {
        const file = input.files[0];
        if(!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                vocabularyData = JSON.parse(e.target.result);
                save(); alert("YÃ¼kleme baÅŸarÄ±lÄ±!"); location.reload();
            } catch(err) { alert("HatalÄ± dosya!"); }
        };
        reader.readAsText(file);
    }

    function speakCurrent() {
        let msg = new SpeechSynthesisUtterance(document.getElementById('target-word').innerText);
        msg.lang = 'en-US'; window.speechSynthesis.speak(msg);
    }

    init();
</script>
</body>
</html>
